# YouTube Shorts 自动互动助手 - 研发计划

## 一、项目概述

### 1.1 项目名称
**YouTube Shorts Helper** - Chrome 浏览器扩展插件

### 1.2 项目目标
开发一个 Chrome 浏览器插件，在用户浏览 YouTube Shorts 时，自动执行订阅（Subscribe）、点赞（Like）、评论（Comment）等互动操作。

### 1.3 核心价值
- 提升互动效率，节省重复操作时间
- 利用浏览器原生环境，天然复用登录状态和代理设置
- 更自然的操作模式，降低被检测风险

---

## 二、功能需求

### 2.1 核心功能

| 功能 | 描述 | 优先级 | 状态 |
|------|------|--------|------|
| **视频信息提取** | 读取 Shorts 的标题、频道名等信息 | P0 | ✅ 已完成 |
| **LLM 智能判断** | 调用大模型判断是否对当前视频进行互动 | P0 | ✅ 已完成 |
| **订阅频道** | 自动点击订阅按钮 | P0 | ✅ 已完成 |
| **点赞视频** | 自动点击点赞按钮 | P0 | ✅ 已完成 |
| **发表评论** | 自动输入评论并发送（评论内容由 LLM 生成） | P0 | ✅ 已完成 |
| **视频变化检测** | 检测 Shorts 视频切换（URL 变化） | P0 | ✅ 已完成 |
| **自动模式** | 检测到新视频后自动执行互动流程 | P0 | ✅ 已完成 |
| **自动划走** | 互动完成后自动切换到下一个视频 | P0 | ✅ 已完成 |

### 2.2 LLM 智能判断功能（重点）

#### 2.2.1 功能描述

当检测到新的 Shorts 视频时：
1. **提取视频信息**：标题、频道名称（已移除描述提取，仅基于标题判断）
2. **调用 LLM API**：将视频信息发送给大模型
3. **获取决策结果**：大模型返回是否互动、互动类型、评论内容
4. **执行互动**：根据 LLM 决策自动执行相应操作
5. **自动划走**：互动完成后自动切换到下一个视频（5-25秒随机延时），或跳过时快速划走（3-6秒）

#### 2.2.2 LLM 输入信息

| 字段 | 来源 | 说明 |
|------|------|------|
| `video_title` | 页面元素 | Shorts 视频标题（主要判断依据） |
| `channel_name` | 页面元素 | 频道/创作者名称（可选，用于上下文） |
| `video_url` | 当前 URL | 视频链接（用于记录） |

> **注意**：已移除 `video_description` 字段，因为 YouTube Shorts 的描述提取不稳定，且标题通常已包含足够信息供 LLM 判断。

#### 2.2.3 LLM 输出格式（JSON）

```json
{
  "should_interact": true,
  "actions": {
    "subscribe": true,
    "like": true,
    "comment": true
  },
  "comment_text": "Great content! Very insightful. 👍",
  "reason": "内容与目标领域相关，值得互动",
  "confidence_score": 0.85
}
```

| 字段 | 类型 | 说明 |
|------|------|------|
| `should_interact` | boolean | 是否应该互动 |
| `actions.subscribe` | boolean | 是否订阅 |
| `actions.like` | boolean | 是否点赞 |
| `actions.comment` | boolean | 是否评论 |
| `comment_text` | string/null | LLM 生成的评论内容 |
| `reason` | string | 决策理由（调试用） |
| `confidence_score` | number | 置信度 0-1 |

#### 2.2.4 Prompt 配置文件

参考 `wechat/config/task_prompt.json` 格式，实际配置文件位于：

**`extension/config/llm_prompt.json`**

> **更新说明**：
> - 移除了 `video_description` 字段，仅基于标题判断
> - 更新了 system_prompt，提供明确的 JSON 格式示例
> - 强调尽可能多地执行互动操作，特别是订阅

### 2.3 辅助功能

| 功能 | 描述 | 优先级 | 状态 |
|------|------|--------|------|
| **状态检测** | 检测是否已订阅/已点赞，避免重复操作 | P0 | ✅ 已完成 |
| **互动记录** | 记录已互动的视频 ID，避免重复 | P1 | ✅ 已完成 |
| **频率限制** | 限制每日内的互动次数 | P1 | ✅ 已完成 |
| **状态提示** | 页面上显示互动状态和 LLM 决策 | P2 | ✅ 已完成 |
| **数据统计** | 统计互动次数（分析数、互动数、跳过数） | P2 | ✅ 已完成 |
| **自动划走** | 互动或跳过后自动切换到下一个视频 | P0 | ✅ 已完成 |

### 2.4 配置功能

| 配置项 | 描述 | 默认值 |
|--------|------|--------|
| **自动模式开关** | 是否启用启用 LLM 智能判断并自动互动 | 开启 |
| 视频切换等待时间 | 切换视频后等待秒数 | 2-4秒 |
| 操作间隔时间 | 各操作之间的间隔 | 0.5-1.5秒 |
| 每小时最大互动数 | 安全限制 | 30 |

#### LLM 配置项

| 配置项 | 描述 | 默认值 |
|--------|------|--------|
| **API Base URL** | LLM API 地址 | `http://localhost:11434/v1` (Ollama) |
| **API Key** | API 密钥 | `ollama` |
| **Model** | 模型名称 | `qwen2.5:3b` |
| **兴趣领域** | 用户定义的互动领域 | 空（全部互动） |
| **最低置信度** | 低于此值不执行互动 | 0.6 |

---

## 三、技术要求

### 3.1 技术规范

| 项目 | 要求 |
|------|------|
| **Manifest 版本** | Manifest V3（Chrome 最新标准） |
| **最低 Chrome 版本** | 88+ |
| **权限范围** | youtube.com 域名 + LLM API 域名 |
| **存储方式** | chrome.storage.sync（跨设备同步） |
| **网络请求** | 在 Service Worker 中调用 LLM API |

### 3.2 LLM 集成技术方案

#### 3.2.1 架构设计

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Content Script │────▶│  Service Worker │────▶│    LLM API      │
│  (YouTube 页面) │     │  (Background)   │     │ (Ollama/OpenAI) │
└─────────────────┘     └─────────────────┘     └─────────────────┘
        │                       │                       │
        │ 1.提取视频信息         │ 2.发送API请求          │
        │                       │                       │
        │◀──────────────────────│◀──────────────────────│
        │      4.执行互动        │   3.返回决策结果       │
```

#### 3.2.2 通信流程

1. **Content Script** (`extension/content/content.js`) 检测到视频变化，提取标题、频道名
2. 通过 `chrome.runtime.sendMessage` 发送到 **Service Worker** (`extension/utils/messaging.js`)
3. **Service Worker** (`extension/background/service-worker.js`) 调用 LLM API，获取决策结果
4. 将决策结果返回给 **Content Script**
5. **Content Script** 根据决策执行互动操作 (`extension/content/interactor.js`)

#### 3.2.3 API 兼容性

支持 OpenAI 兼容格式的 API（与 `llm_client.py` 保持一致）：

| 服务 | API Base URL | 说明 |
|------|--------------|------|
| **Ollama（本地）** | `http://localhost:11434/v1` | 本地部署，免费 |
| **OpenAI** | `https://api.openai.com/v1` | 云端，需 API Key |
| **其他兼容服务** | 用户自定义 | 如 Azure OpenAI、Groq 等 |

#### 3.2.4 API 请求格式

LLM API 调用实现位于：

**`extension/background/llm-client.js`**

主要方法：`LLMClient.analyzeVideo(videoInfo, systemPrompt)`

#### 3.2.5 视频信息提取选择器

视频信息提取选择器配置位于：

**`extension/utils/selectors.js`** - `SELECTORS.videoInfo`

提取逻辑实现位于：

**`extension/content/video-info.js`** - `VideoInfoExtractor`

> **注意**：已移除 `description` 选择器，因为描述提取不稳定且标题通常已包含足够信息。

### 3.3 选择器配置

所有选择器配置位于：

**`extension/utils/selectors.js`**

包含：
- `SELECTORS.videoInfo` - 视频信息提取选择器（标题、频道名）
- `SELECTORS.interactions` - 互动操作选择器（订阅、点赞、评论）
- `SELECTORS.container` - 容器选择器

互动操作实现位于：

**`extension/content/interactor.js`** - `Interactor`

### 3.4 视频变化检测

视频变化检测实现位于：

**`extension/content/content.js`**

采用定时器检测 URL 变化（1秒间隔）+ `popstate` 事件监听的方式。

---

## 四、项目结构

```
auto_helper/
├── DEVELOPMENT_PLAN.md          # 本文档
├── README.md                    # 使用说明
├── extension/                   # 插件源码目录
│   ├── manifest.json            # 插件配置文件
│   ├── config/
│   │   └── llm_prompt.json      # LLM Prompt 配置文件
│   ├── background/
│   │   ├── service-worker.js    # Service Worker 入口
│   │   └── llm-client.js        # LLM API 客户端
│   ├── content/
│   │   ├── content.js           # 内容脚本入口（包含视频检测逻辑）
│   │   ├── video-info.js        # 视频信息提取（仅标题和频道名）
│   │   ├── interactor.js        # 互动操作执行（订阅、点赞、评论、划走）
│   │   └── ui-overlay.js        # 页面状态提示 UI
│   ├── popup/
│   │   ├── popup.html           # 弹出窗口 HTML
│   │   ├── popup.js             # 弹出窗口逻辑
│   │   └── popup.css            # 弹出窗口样式
│   ├── options/
│   │   ├── options.html         # 设置页面 HTML
│   │   ├── options.js           # 设置页面逻辑
│   │   └── options.css          # 设置页面样式
│   ├── utils/
│   │   ├── storage.js           # 存储工具
│   │   ├── selectors.js         # 选择器配置
│   │   └── messaging.js         # 消息通信工具
│   └── assets/
│       └── icons/
│           ├── icon16.png
│           ├── icon48.png
│           └── icon128.png
└── scripts/
    └── build.js                 # 构建脚本（可选）
```

---

## 五、开发步骤

### 阶段一：基础框架搭建（Step 1-3）

#### Step 1: 创建项目结构
- [ ] 创建目录结构
- [ ] 创建 manifest.json（Manifest V3）
- [ ] 配置权限：youtube.com、storage、网络请求
- [ ] 创建基础图标占位符

#### Step 2: 实现 Popup 界面
- [ ] 创建 popup.html 基础布局
- [ ] 实现自动模式开关（唯一开关，控制 LLM 智能判断和自动互动）
- [ ] 显示 LLM 连接状态
- [ ] 显示今日互动统计
- [ ] 添加基础样式

#### Step 3: 实现 Content Script 基础
- [ ] 创建 content.js 入口
- [ ] 实现选择器配置模块
- [ ] 实现与 Service Worker 的消息通信

### 阶段二：核心功能实现（Step 4-8）

#### Step 4: 实现视频信息提取
- [x] 实现 `extractVideoInfo()` 提取标题、频道名（已移除描述提取）
- [x] 处理元素加载时机问题（等待元素出现，重试机制）
- [x] 测试不同类型 Shorts 页面的兼容性（多选择器备选策略）

#### Step 5: 实现 LLM 客户端（重点）
- [x] 在 Service Worker 中实现 `LLMClient` 类
- [x] 实现 API 配置管理（Base URL、API Key、Model）
- [x] 实现 `analyzeVideo(videoInfo, systemPrompt)` 调用方法
- [x] 实现 JSON 响应解析和错误处理（支持 markdown code block 清理）
- [x] 创建 `config/llm_prompt.json` 配置文件
- [x] 实现 prompt 模板格式化（仅标题）
- [x] 实现 actions 格式归一化（支持字符串/数组/对象格式）

#### Step 6: 实现视频变化检测
- [x] 监听 popstate 事件
- [x] 使用定时器检测 URL 变化（1秒间隔）
- [x] 提取视频 ID（从 URL 中提取）
- [x] 视频变化时触发完整流程：提取信息 → LLM 判断 → 执行互动 → 自动划走

#### Step 7: 实现互动操作
- [x] 实现 `subscribe()` 订阅功能
- [x] 实现 `like()` 点赞功能
- [x] 实现 `comment(text)` 评论功能（使用 LLM 生成的内容，含重试逻辑）
- [x] 实现状态检测（是否已订阅/已点赞）
- [x] 实现随机延时，模拟真人操作
- [x] 实现 `swipeNext()` 自动划走功能（模拟 ArrowDown 按键）

#### Step 8: 实现自动模式完整流程
- [x] 整合：视频检测 → 信息提取 → LLM 决策 → 执行互动 → 自动划走
- [x] 根据 LLM 返回的 `should_interact` 决定是否互动
- [x] 根据 `actions` 决定执行哪些操作（支持格式归一化）
- [x] 使用 `comment_text` 作为评论内容
- [x] 记录已互动视频避免重复
- [x] 实现自动划走：互动后 5-25秒随机延时，跳过后 3-6秒快速划走

### 阶段三：配置与优化（Step 9-11）

#### Step 9: 实现配置存储
- [x] 使用 chrome.storage.sync 存储配置
- [x] 存储自动模式开关状态
- [x] 存储 LLM 配置（API URL、Key、Model）
- [x] 存储安全设置（每日最大互动数、跳过已互动、最低置信度）
- [x] 实现配置读取和保存（带默认值）

#### Step 10: 实现 Options 设置页面
- [x] LLM 配置区域（API 设置、模型选择）
- [x] 安全设置区域（每日最大互动数、跳过已互动、最低置信度）
- [x] 测试 LLM 连接按钮（支持 Ollama CORS 检测和错误提示）
- [x] 配置保存和加载功能

#### Step 11: 安全与限制
- [x] 实现频率限制（每日最大互动数，自动重置）
- [x] 实现最低置信度检查
- [x] 实现互动统计和日志（分析数、互动数、跳过数）
- [x] 实现错误处理和用户提示（UI 状态提示、Console 日志）

### 阶段四：完善与测试（Step 12-13）

#### Step 12: UI 优化
- [x] 实现页面状态提示（显示 LLM 决策结果，右上角浮动提示）
- [x] 优化 Popup 和 Options UI 样式
- [x] 添加 LLM 调用状态指示（加载中、成功、失败、跳过）
- [x] 实现自动隐藏动画（4秒后淡出）

#### Step 13: 全面测试与文档
- [x] 测试本地 Ollama 模型（含 CORS 配置）
- [x] 测试云端 API（OpenAI 兼容格式）
- [x] 测试各种 Shorts 视频类型
- [x] 边界情况测试（仅标题、特殊字符、选择器失效等）
- [x] 编写 README 使用文档（含安装、配置、调试、CORS 说明）
- [x] 代码清理：移除冗余注释、未使用代码、临时产物

---

## 六、UI 设计

### 6.1 Popup 界面

```
┌─────────────────────────────────────┐
│  🎬 YouTube Shorts Helper          │
├─────────────────────────────────────┤
│                                     │
│  🤖 自动模式（LLM 智能判断）        │
│  ─────────────────────────────────  │
│  [○ 关闭] ←────→ [● 开启]           │
│                                     │
│  ─────────────────────────────────  │
│  🧠 LLM 状态                        │
│  ─────────────────────────────────  │
│  模型: qwen2.5:3b                   │
│  状态: ● 已连接                     │
│                                     │
│  ─────────────────────────────────  │
│  📊 今日统计                        │
│  ─────────────────────────────────  │
│  已分析: 25 个视频                  │
│  已互动: 15 个视频                  │
│  LLM 跳过: 10 个视频                │
│                                     │
│  [⚙️ 设置]                          │
└─────────────────────────────────────┘
```

> **说明**：自动模式开启后，LLM 会智能判断每个视频是否值得互动，并自动决定执行订阅、点赞、评论中的哪些操作。

### 6.2 Options 设置页面

```
┌─────────────────────────────────────────────────────────┐
│  YouTube Shorts Helper - 设置                           │
├─────────────────────────────────────────────────────────┤
│                                                         │
│  🧠 LLM 配置                                            │
│  ────────────────────────────────────────────          │
│  API Base URL: [http://localhost:11434/v1    ]         │
│  API Key:      [ollama                       ]         │
│  Model:        [qwen2.5:3b                   ]         │
│  [测试连接]                                             │
│                                                         │
│  📝 Prompt 配置                                         │
│  ────────────────────────────────────────────          │
│  兴趣领域（留空则全部互动）:                            │
│  [科技, 编程, AI, 创业                       ]         │
│                                                         │
│  System Prompt:                                         │
│  ┌─────────────────────────────────────────┐           │
│  │ 你是一个 YouTube 内容分析助手...        │           │
│  │ ...                                      │           │
│  └─────────────────────────────────────────┘           │
│                                                         │
│  最低置信度: [0.6]                                      │
│                                                         │
│  ⏱️ 延时设置                                            │
│  ────────────────────────────────────────────          │
│  视频切换后等待:  最小 [2] 秒  最大 [4] 秒              │
│  操作间隔:        最小 [0.5] 秒  最大 [1.5] 秒          │
│                                                         │
│  🛡️ 安全设置                                            │
│  ────────────────────────────────────────────          │
│  每小时最多互动: [30] 个视频                            │
│  [✓] 跳过已互动过的视频                                 │
│                                                         │
│  📊 数据管理                                            │
│  ────────────────────────────────────────────          │
│  [清除互动记录]  [导出统计数据]                         │
│                                                         │
│  [保存设置]                                             │
└─────────────────────────────────────────────────────────┘
```

### 6.3 页面状态提示

在 Shorts 页面右上角显示小型状态指示器：

```
┌──────────────────────────────────┐
│ 🤖 自动模式                      │
│ 🧠 LLM: 分析中...               │
└──────────────────────────────────┘

┌──────────────────────────────────┐
│ 🤖 自动模式                      │
│ ✅ 已互动 (置信度: 0.85)         │
└──────────────────────────────────┘

┌──────────────────────────────────┐
│ 🤖 自动模式                      │
│ ⏭️ LLM 建议跳过                  │
└──────────────────────────────────┘
```

---

## 七、风险与注意事项

### 7.1 技术风险

| 风险 | 影响 | 缓解措施 | 状态 |
|------|------|----------|------|
| YouTube UI 更新导致选择器失效 | 功能失效 | 使用多种选择器策略、定期维护 | ✅ 已实现 |
| LLM 服务不可用 | 无法决策 | 提供降级策略（跳过或使用默认规则） | ✅ 已实现 |
| LLM 返回格式异常 | 解析失败 | 健壮的 JSON 解析、错误处理、格式归一化 | ✅ 已实现 |
| 视频信息提取失败 | 无法分析 | 多选择器备选、等待元素加载、重试机制 | ✅ 已实现 |
| 评论发送失败 | 操作不完整 | 增加重试机制、错误提示、placeholder 激活 | ✅ 已实现 |
| 操作过快被限制 | 临时限制 | 随机延时、频率控制、模拟真人操作 | ✅ 已实现 |
| Ollama CORS 限制 | 无法连接 | 配置 `OLLAMA_ORIGINS="*"`，提供明确错误提示 | ✅ 已解决 |

### 7.2 LLM 相关风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| LLM 生成不当评论 | 账号风险 | 设置评论长度限制、敏感词过滤 |
| LLM 响应延迟 | 用户体验差 | 设置超时、显示加载状态 |
| Ollama 未启动 | 功能不可用 | 检测并提示用户启动 |
| API 费用（云端） | 成本 | 默认使用本地 Ollama |

### 7.3 安全风险

| 风险 | 影响 | 缓解措施 |
|------|------|----------|
| 操作频率过高 | 账号警告/限制 | 严格频率限制、模拟真人行为 |
| 垃圾评论 | 账号封禁 | LLM 智能生成、用户可审核 |
| API Key 泄露 | 安全问题 | 本地存储、不上传云端 |

### 7.4 使用建议

1. **首次使用建议先测试 LLM 连接**，确保本地 Ollama 正常运行（需配置 `OLLAMA_ORIGINS="*"`）
2. **LLM 基于标题判断**，Prompt 已优化为尽可能多地互动，特别是订阅
3. **评论功能谨慎使用**，LLM 生成的评论应保持友好、自然（10-50字）
4. **控制互动频率**，建议每日最大互动数设置在 30-50 之间
5. **定期检查功能是否正常**，YouTube 可能更新 UI，选择器可能失效
6. **关注 Console 日志**，查看 `[Content]`、`[Interactor]`、`[Background]` 标签的日志
7. **刷新插件后必须刷新 YouTube 页面**，避免 Extension context invalidated 错误

---

## 八、测试计划

### 8.1 功能测试

| 测试项 | 测试内容 | 预期结果 | 状态 |
|--------|----------|----------|------|
| **视频信息提取** | 打开 Shorts 页面，提取标题、频道名 | 正确提取标题和频道名 | ✅ 通过 |
| **LLM 连接测试** | 配置 Ollama 地址，点击测试连接 | 显示连接成功 | ✅ 通过 |
| **LLM 决策测试** | 发送视频信息给 LLM，获取决策 | 返回正确 JSON 格式 | ✅ 通过 |
| **订阅功能** | LLM 决定订阅时，点击订阅按钮 | 成功订阅，按钮状态变化 | ✅ 通过 |
| **点赞功能** | LLM 决定点赞时，点击点赞按钮 | 成功点赞，按钮高亮 | ✅ 通过 |
| **评论功能** | LLM 生成评论内容并发送 | 评论成功发送 | ✅ 通过 |
| **视频检测** | 上下滑动切换视频 | 正确检测到视频 ID 变化 | ✅ 通过 |
| **自动流程** | 开启自动模式后滑动视频 | 完整执行：检测→提取→LLM→互动→划走 | ✅ 通过 |
| **跳过决策** | LLM 返回 should_interact=false | 正确跳过，不执行互动，自动划走 | ✅ 通过 |
| **状态检测** | 对已订阅/已点赞的视频 | 正确跳过不重复操作 | ✅ 通过 |
| **置信度过滤** | LLM 返回低置信度 | 不执行互动 | ✅ 通过 |
| **自动划走** | 互动或跳过完成后 | 自动切换到下一个视频 | ✅ 通过 |

### 8.2 LLM 测试场景

| 场景 | 输入 | 预期 LLM 输出 | 状态 |
|------|------|---------------|------|
| 符合兴趣的视频 | 科技/编程相关标题 | should_interact=true | ✅ 通过 |
| 不符合兴趣的视频 | 娱乐/八卦相关标题 | should_interact=false | ✅ 通过 |
| 仅标题视频 | 仅有标题（无描述） | 仍能做出判断 | ✅ 通过 |
| 特殊字符 | emoji、特殊符号 | 正常处理 | ✅ 通过 |

### 8.3 测试链接

```
https://www.youtube.com/shorts/fWYsEgLYu_g
```

### 8.4 测试环境

| 环境 | 配置 |
|------|------|
| **LLM 本地** | Ollama + qwen2.5:3b |
| **LLM 云端** | OpenAI API (可选) |
| **浏览器** | Chrome 88+ |

---

## 九、验收标准

### 9.1 必须完成（P0）

- [x] 能正确检测 Shorts 视频变化
- [x] 能正确提取视频标题、频道名（已移除描述提取）
- [x] 能成功调用 LLM API 获取决策结果
- [x] 能解析 LLM 返回的 JSON 格式（支持格式归一化）
- [x] 根据 LLM 决策自动执行订阅操作
- [x] 根据 LLM 决策自动执行点赞操作
- [x] 根据 LLM 决策自动执行评论操作（使用 LLM 生成内容）
- [x] 能正确检测已订阅/已点赞状态，避免重复
- [x] Popup 界面正常显示和交互
- [x] 互动完成后自动划到下一个视频

### 9.2 应该完成（P1）

- [x] 自动模式完整流程正常工作
- [x] LLM 配置保存和读取正常
- [x] Options 设置页面可配置 LLM 参数
- [x] 置信度过滤生效
- [x] 频率限制生效（每日限制，自动重置）
- [x] 已互动视频记录和跳过

### 9.3 可选完成（P2）

- [x] 页面状态提示 UI（显示 LLM 决策，右上角浮动提示）
- [x] 互动统计数据（分析数、互动数、跳过数，在 Popup 显示）
- [x] 测试 LLM 连接功能（Options 页面，含 CORS 错误提示）

---

## 十、开发阶段概览

| 阶段 | 内容 | 步骤 |
|------|------|------|
| **阶段一** | 基础框架搭建 | Step 1-3 |
| **阶段二** | 核心功能实现（含 LLM） | Step 4-8 |
| **阶段三** | 配置与优化 | Step 9-11 |
| **阶段四** | 完善与测试 | Step 12-13 |

---

## 十一、关键技术决策

| 决策点 | 选择 | 理由 |
|--------|------|------|
| **LLM 调用位置** | Service Worker | Manifest V3 要求，且网络请求应在后台执行 |
| **API 格式** | OpenAI 兼容 | 与现有 llm_client.py 保持一致，支持多种后端 |
| **默认模型** | qwen2.5:3b | 中文能力强，资源占用适中 |
| **Prompt 存储** | 配置文件 + storage | 预置模板 + 用户可自定义 |
| **通信方式** | chrome.runtime.sendMessage | 标准的 Content ↔ Service Worker 通信 |

---
